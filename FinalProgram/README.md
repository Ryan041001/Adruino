# 🎙️ 适老化语音备忘录系统

一套专为老年人设计的智能语音备忘录系统，旨在通过简洁的交互方式，帮助老年人轻松管理日常生活中的提醒事项。系统集成了语音识别、自然语言处理和定时提醒功能，并提供了一个清晰直观的图形用户界面。

## 🌟 主要功能

- **🎤 智能语音交互**: 用户可以通过自然语言（例如"提醒我明天下午三点喝水"）来设置提醒，系统能够准确识别并解析时间和事件。
- **⏰ 多提醒并发管理**: 支持同时运行多个提醒事项的倒计时，最多可管理 20 个并发提醒，每个提醒都有独立的倒计时显示。
- **🔔 智能提醒分级**: 根据剩余时间自动分级显示：
  - 🟢 普通提醒（5 分钟以上）
  - 🟡 紧急提醒（5 分钟内）
  - 🔴 关键提醒（1 分钟内）
- **📱 实时倒计时更新**: 界面每秒更新所有活跃提醒的倒计时，确保时间显示准确。
- **🎯 精准定时提醒**: 在预定时间通过语音和界面提示用户，支持多个提醒同时触发。
- **🧠 增强语义识别**: 集成 jieba 中文分词库，提高时间表达式识别准确性，支持更自然的语言输入。
- **🔄 连续录音支持**: GUI 状态智能重置，支持连续添加多个提醒，无需重启应用。
- **💬 实时消息通知**: 家人或护工可以通过配套的 Web 界面向老人的设备发送文字消息，加强沟通。
- **🖥️ 现代化图形界面**: 基于 `PyQt5` 构建，界面元素清晰、字体宽大，操作简单，符合老年用户的使用习惯。
- **🛠️ 灵活的配置**: 系统核心参数（如 API 密钥、服务器端口等）均可通过 `config.py` 文件进行配置。

## 📸 界面截图

_此处可以放置应用运行时的截图_

## 🛠️ 技术栈

- **后端**: Python
- **GUI 框架**: PyQt5
- **Web 框架**: Flask (用于接收外部消息)
- **语音识别**: 百度语音 API
- **自然语言处理 (NLU)**: DeepSeek API
- **语音合成 (TTS)**: 讯飞语音 API
- **定时任务**: APScheduler

## 📁 项目结构

```
FinalProgram/
├── src/                      # 核心源代码目录
│   ├── gui_controller.py       # GUI界面控制器
│   ├── voice_assistant.py    # 语音助手，处理语音识别和NLU
│   ├── reminder.py           # 提醒管理模块
│   ├── web_server.py         # Flask Web服务器
│   ├── gui_button_controller.py # 按钮事件控制器
│   └── ...
├── main.py                   # 主程序入口
├── config.py                 # 配置文件 (API密钥, 路径等)
├── requirements.txt          # Python依赖包
├── assets/                   # 存放静态资源，如图标、提示音
├── data/                     # 存放数据文件，如reminders.json
├── logs/                     # 日志文件目录
└── README.md                 # 项目说明文件
```

## 💻 运行环境

本程序设计运行在 **树莓派 3B（Raspberry Pi 3B）** 上，并已在该环境下完成测试。理论上也可在其他具有相似性能和 GPIO 接口的 Linux 设备上运行。

## 🚀 快速开始

### 1. 克隆项目

```bash
git clone <your-repository-url>
cd FinalProgram
```

### 2. 配置环境

- **安装 Python 依赖**:

  ```bash
  pip install -r requirements.txt
  ```

- **配置 API 密钥**:
  打开 `config.py` 文件，填入您申请的 `DeepSeek`、`百度语音` 和 `讯飞` 的 API 密钥。

  ```python
  # config.py

  DEEPSEEK_API_KEY = 'Your_DeepSeek_API_Key'
  BAIDU_APP_ID = 'Your_Baidu_App_ID'
  BAIDU_API_KEY = 'Your_Baidu_API_Key'
  BAIDU_SECRET_KEY = 'Your_Baidu_Secret_Key'
  XUNFEI_APP_ID = 'Your_Xunfei_App_ID'
  # ... etc.
  ```

### 3. 运行程序

```bash
python main.py
```

程序启动后，将会显示主界面，并开始监听语音指令。

## 📝 使用说明

1.  **启动程序**: 运行 `main.py`。
2.  **设置提醒**: 点击"开始录音"按钮，然后说出您的提醒指令，例如："提醒我今天晚上八点吃药"。
3.  **多提醒管理**: 系统支持同时设置多个提醒，每个提醒都会在界面右侧显示独立的倒计时。
4.  **提醒状态**: 界面会根据剩余时间用不同颜色和图标标识提醒的紧急程度。

## 🧪 测试多提醒功能

系统提供了专门的测试脚本来验证多提醒功能：

### 运行测试脚本

```bash
# 测试基础多提醒功能
python test_multiple_reminders.py

# 测试改进后的功能（包含jieba语义识别）
python test_improved_features.py
```

### 基础多提醒测试功能

- **多提醒创建**: 自动创建 5 个不同时间的测试提醒
- **并发倒计时**: 验证多个提醒同时倒计时的功能
- **提醒分级**: 测试紧急和关键提醒的分级显示
- **同时触发**: 验证多个提醒同时到期时的处理
- **状态管理**: 测试提醒的生命周期管理

### 改进功能测试

- **jieba 语义识别**: 测试中文分词和时间表达式提取
- **复杂时间解析**: 验证"明天下午五点"等自然语言的识别
- **GUI 状态重置**: 测试连续录音功能
- **智能时间合并**: 验证本地提取与 LLM 解析的结合

### 预期输出示例

```
🚀 开始测试多提醒功能
📝 添加测试提醒: 测试提醒1 - 1分钟后
📝 添加测试提醒: 测试提醒2 - 2分钟后
📝 添加测试提醒: 测试提醒3 - 3分钟后
📝 添加测试提醒: 测试提醒4 - 4分钟后
📝 添加测试提醒: 测试提醒5 - 5分钟后

=== 系统状态摘要 ===
活跃提醒数量: 5
紧急提醒数量: 2
关键提醒数量: 1

=== jieba时间提取测试 ===
测试: 提醒我明天下午五点吃药
jieba提取: {'value': 17, 'unit': '小时', 'confidence': 0.95}
意图解析: {'intent': 'set_reminder', 'task': '吃药', 'confidence': 0.95}

⏰ 监控提醒状态中...
🔔 提醒触发: 测试提醒1
🔔 提醒触发: 测试提醒2
...
🎉 所有提醒已完成!
```

3.  **查看提醒**: 设置成功后，提醒事项会显示在右侧的“提醒事项”区域。
4.  **接收消息**: 通过访问 `http://<your-ip-address>:5000` 可以打开一个简单的 Web 页面，用于向设备发送消息。

## 🤝 贡献

欢迎提交 PR 或 Issue 来改进这个项目。
